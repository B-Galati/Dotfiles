#!/bin/bash

CONTAINER_NAME="cadvisor"
RUNNING=$(docker inspect --format="{{ .State.Running }}" $CONTAINER_NAME 2> /dev/null)

case "$1" in
        start)
		if [ "$RUNNING" == "true" ]; then
			echo "already running..."
			exit 2
		fi

		if [ "$RUNNING" == "false" ]; then
			echo "starting container..."
			docker start $CONTAINER_NAME
		else
			echo "running container..."
			docker run \
			  --volume=/:/rootfs:ro \
			  --volume=/var/run:/var/run:rw \
			  --volume=/sys:/sys:ro \
			  --volume=$home/docker/:/var/lib/docker:ro \
			  --publish=8080:8080 \
			  --detach=true \
			  --name=$CONTAINER_NAME \
			  google/cadvisor:latest
		fi
        ;;

        stop)
		echo "Stoping container..."
		docker stop $CONTAINER_NAME	
        ;;

	rm)
		echo "Deleting container..."
		docker rm -v $CONTAINER_NAME
	;;

        *)
                echo "Usage: $0 {start|stop|rm}"
                exit 1
        ;;
esac

