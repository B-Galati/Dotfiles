#!/bin/bash

CONTAINER_NAME="keepass2"
RUNNING=$(docker inspect --format="{{ .State.Running }}" $CONTAINER_NAME 2> /dev/null)

case "$1" in
        start)
                if [ "$RUNNING" == "true" ]; then
                        echo "already running..."
                        exit 2
                fi

                if [ "$RUNNING" == "false" ]; then
                        echo "starting container..."
                        docker start $CONTAINER_NAME
                else
                        echo "running container..."
			docker run  -it  \
				-v /tmp/.X11-unix:/tmp/.X11-unix \
				-v $HOME/keepass:/home/keepass \
				-v $HOME/.config/KeePass/KeePass.config.xml:/home/keepass/.config/KeePass/KeePass.config.xml \
				-e DISPLAY=unix$DISPLAY \
				--name $CONTAINER_NAME \
				benoitg/keepass2
                fi
        ;;

        stop)
                echo "Stoping container..."
                docker stop $CONTAINER_NAME
        ;;

        rm)
                echo "Deleting container..."
                docker rm -v $CONTAINER_NAME
        ;;

        *)
                echo "Usage: $0 {start|stop|rm}"
                exit 1
        ;;
esac

